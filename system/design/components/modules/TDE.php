<? define('_base64_decode_', 0); define('_base64_encode_', 1); define('_gzcompress_', 2); define('_gzuncompress_', 3); define('_unserialize_', 4); define('_serialize_', 5); Class TDE Extends __TNoVisual{public Function __construct($owner=nil,$self=nil){ parent::__construct($owner,$self); if ($self==nil){ $this->type =_base64_decode_; }}function ec(){ if(!$this->data) return false; switch($this->type){ case _base64_decode_: $data =base64_decode($this->data); break; case _base64_encode_: $data =base64_encode($this->data); break; case _gzcompress_: $data =gzcompress($this->data, 9); break; case _gzuncompress_: $data =gzuncompress($this->data); break; case _serialize_: $this->serialize =false; $data =serialize($this->data); break; case _unserialize_: $this->serialize =false; $data =unserialize($this->data); break; default: return $data; break; }if(!$data) return false; return !$this->serialize ?$data :serialize($data); }}